# v9.1 - CRITICAL FIX: Unstranded Removal

## The Bug in v9.0

v9.0 used **strand-specific removal** (`-s -v`), but the OLD bash script used **unstranded removal** (`-v` only)!

### Old Bash Script (CORRECT):
```bash
# Step 1: Assign same-strand reads
bedtools intersect -s -u -wa -a reads.bed -b ppPolII.txt > promoter_reads.bed

# Step 1: Remove ALL overlapping reads (NO STRAND FLAG!)
bedtools intersect -v -a reads.bed -b ppPolII.txt > remaining.bed
```

### v9.0 (WRONG):
```python
# Assignment: same-strand
run([BT, "intersect", "-s", "-u", "-wa", "-a", reads, "-b", ppPolII], prom_reads)

# Removal: ALSO same-strand (WRONG!)
run([BT, "intersect", "-s", "-v", "-a", reads, "-b", ppPolII], removed)
```

## The Impact

**v9.0 with strand-specific removal:**
- Only removed same-strand reads
- Opposite-strand reads stayed in the pool
- They got assigned to wrong categories later
- Result: Promoter dropped 77%, Non-localized increased to 43%!

**v9.1 with unstranded removal (like old script):**
- Removes ALL reads overlapping a region (both strands)
- Prevents reads from being assigned to multiple incompatible categories
- Should match old bash script behavior

## The Fix (v9.1)

Changed ALL removal steps to use **unstranded** (`-v` without `-s` or `-S`):

```python
# Step 1: Promoter
run([BT, "intersect", "-s", "-u", "-wa", "-a", reads, "-b", ppPolII], prom_reads)
run([BT, "intersect", "-v", "-a", reads, "-b", ppPolII], removed)  # ← NO STRAND FLAG!

# Step 2: Divergent
run([BT, "intersect", "-S", "-u", "-wa", "-a", reads, "-b", divTx], div_reads)
run([BT, "intersect", "-v", "-a", reads, "-b", divTx], removed)  # ← NO STRAND FLAG!

# ... and so on for all steps
```

## Expected Results

v9.1 should now EXACTLY match the original TrackTx bash pipeline behavior!

This should give us the baseline to compare against and understand where our non-localized reads issue really comes from.

